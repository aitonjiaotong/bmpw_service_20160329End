<!DOCTYPE html>
<html>
<head>
    <title>八闽租车系统</title>
    <meta charset="utf-8"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="JS/jquery.dataTables.css" type="text/css"/>
    <style>
        html,body{
            margin: 0;
            height: 100%;
        }
        .top1{
            background-color: #4a4a4a;
            color: #ffffff;
            margin: 0;
            width: 20%;
            height: 50px;
            line-height: 50px;
            text-align: center;
            border-right:1px solid #ffffff ;
            font-size: 30px;
            float: left;
        }
        .top2{
            width: 100%;
            background-color: #4a4a4a;
            height: 50px;
        }
        .lan1{
            width: 20%;
            height: 100%;
            background-color: #1f5377;
            color: #ffffff;
        }
        .top3{
            color: #ffffff;
            height: 65px;
            background-color: #1f5377;
            width: 79.95%;
            float: right;
            border-left:1px solid #ffffff;

        }
        .mainpage{
            width: 79.9%;
            float: right;
            clear: left;
            padding-top: 20px;;
        }
        .icon{

            text-align: center;
            color: #ffffff;
            padding-bottom: 10px;
            padding-top: 10px ;
        }
        #icon{
            height: 85px;
            width: 85px;
        }
        .op p{
            margin: 10px 0;
            padding-top: 0;
            height: 48px;
            line-height: 48px;
        }
        .op p a{
            clear: left;
            text-decoration: none;
            color: #ffffff;
            font-size: 25px;
            margin: 10px 10px;
        }
        .op p a img{
            float: left;
        }
        #biao{
            width: 100%;
        }
        .check{
            float: left;
            height: 48px;
            margin-right: 25px;
            visibility: hidden;
        }
        .show{
            visibility: visible;
        }
        .c{
            background-color: #24638e;
        }
        .top3 div{
            height:65px;
            margin: 0 30px;
            line-height: 65px;
            font-size: 25px;
        }
        .top3 p{
            margin: 0;
        }
        .top3 p img{
            margin: 10px;
            float: left;
            margin-right: 20px;
        }
        #zuo{
            width: 50%;
            float: left;
        }
        #btns{
            text-align: center;
            width: 100%;
            clear:right;
        }
        #you{
            width: 50%;
            float: right;
        }
        input,textarea{
            border-radius:3px;border:1px solid #000;
            border-radius: 5px;
            padding-left:10px;
        }
        button,select{
            width:100px;
            height: 25px;;
            clear:right;
            float:left;
            margin-left: 20px;
            margin-top: 10px;
            border-radius:3px;border:1px solid #000;
        }
        input[type=text]{
            border-radius:3px;border:1px solid #000;
            height: 25px;
            padding-left:10px;
            margin-top: 10px;
            margin-bottom: 10px;
        }
        .light{
            color: red;
        }
        .oo{
            background-color: #cccccc;
        }
        #accounts{
            text-align: center;
        }
    </style>
</head>
<body>
<div class="top1">租车行</div>
<div class="top2"></div>
<div class="top3"><div><p><img src="images/kehu.png">客户</p></div></div>
<div class="mainpage">
    <div id="zuo">
        <table id="accounts">
            <thead>
                <th>客户证件号</th>
                <th>客户名</th>
                <th>联系方式</th>
            </thead>
        </table>
    </div>
    <div id="you">
        <table style="margin-left:20px;">
            <tr>
                <td>客户证件号</td>
                <td colspan="3"><input type="text" style="width: 99.2%" name="idCard"/></td>
            </tr>
            <tr>
                <td>名称</td>
                <td><input type="text" name="name"/></td>
                <td>证件类型</td>
                <td><!--<input type="text" cardStatus/>-->
                    <select name="cardStatus">
                        <option value="0">居民身份证</option>
                        <option value="1">士兵证</option>
                        <option value="2">军官证</option>
                        <option value="3">警官证</option>
                        <option value="4">护照</option>
                        <option value="5">其他</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>银行卡号</td>
                <td><input type="text" name="bankCard"/></td>
                <td>银行卡类型</td>
                <td>
                    <select>
                        <option value="">工商银行</option>
                        <option value="">农业银行</option>
                        <option value="">建设银行</option>
                        <option value="">交通银行</option>
                        <option value="">招商银行</option>
                        <option value="">中国银行</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>电话号码</td>
                <td colspan="3"><input type="text" style="width: 99.2%" name="phone"/></td>
            </tr>
            <tr>
                <td>地址</td>
                <td colspan="3"><input type="text" style="width: 99.2%" name="address"/></td>
            </tr>
            <tr>
                <td style="float: left">备注</td>
                <td colspan="3"><textarea style="width: 98.8%;height: 300px" name="note"></textarea></td>
            </tr>
        </table>
        <input type="hidden" name="accountId"/>
        <div id="btns">
            <button style="margin-left: 140px;" onclick="addAccount();">新增客户</button>
            <button onclick="updateAccount();">保存修改</button>
            <button onclick="exitPage();">退出</button>
        </div>
    </div>
</div>
<div class="lan1">
    <div class="icon">
        <div>
            <div><img id="icon" src="icon/touxiang.png"/></div>
            <div><img src="images/lvdian.png"/><label>Admin</label></div>
            <div><img id="biao" src="images/baisetiao.png"/> </div>
        </div>
    </div>
    <div class="op">
        <p><img class="check" src="images/check.png"><a href="/bmpw/toZC_Cheliangxinxi"><img src="images/chelianxinxi.png">车辆信息</a></p>
        <p><img class="check" src="images/check.png"><a href="/bmpw/toZC_AddCar"><img src="images/chelianxinzeng.png"/>车辆新增</a></p>
        <p><img class="check" src="images/check.png"><a href="/bmpw/toZC_Plans"><img src="images/zulenfangan.png">租赁方案</a></p>
        <p><img class="check" src="images/check.png"><a href="/bmpw/toZC_Zuche"><img src="images/zuche.png">租车</a></p>
        <p><img class="check" src="images/check.png"><a href="/bmpw/toZC_ReturnCar"><img src="images/huanche.png"/>还车</a></p>
        <p><img class="check" src="images/check.png"><a href="/bmpw/toZC_Settlement"><img src="images/jiesuan.png"/>结算</a></p>
        <p class="c"><img class="check show" src="images/check.png"><a href="#"><img src="images/kehu.png"/>客户</a></p>
        <p><img class="check" src="images/check.png"><a href="/bmpw/toZC_Appointment"><img src="images/yudingdengji.png"/>预定登记</a></p>
    </div>
</div>
<script src="JS/jquery-1.12.0.js"></script>
<script src="JS/jquery.dataTables.js"></script>
<script>
    $(function(){
       $("#accounts").dataTable({
           "serverSide":true,
           "processing": true,
           "ajax":"/bmpw/zc/account/loadaccounts",
           "bSort":false,
           "bLengthChange":false,
           "bInfo":false,
           "iDisplayLength" : 15,
           "oLanguage": {
               "sLengthMenu": "每页显示 _MENU_ 条记录",
               "sZeroRecords": "抱歉， 没有找到",
               "sInfo": "从 _START_ 到 _END_ /共 _TOTAL_ 条数据",
               "sInfoEmpty": "没有数据",
               "sInfoFiltered": "(从 _MAX_ 条数据中检索)",
               "oPaginate": {
                   "sFirst": "首页",
                   "sPrevious": "前一页",
                   "sNext": "后一页",
                   "sLast": "尾页"
               },
               "sSearch":"根据电话查询"
           },
           "columns":[
               {"data":"idCard"},
               {"data":"name"},
               {"data":"phone"}
           ]
       });
       $("#zuo").on("click","td",function(){
           $("tr.light").removeClass("light");
           $($(this).parent("tr")).addClass("light");
           $("td.oo").removeClass("oo");
           $(this).addClass("oo");
           $(this).siblings().addClass("oo");
           var data = $("#accounts").DataTable().row($(this).parents("tr")).data();
           $(":input[name=accountId]").val(data.id);
           $(":input[name=idCard]").val(data.idCard);
           $(":input[name=name]").val(data.name);
           $(":input[name=cardStatus]").val(data.cardStatus);
           $(":input[name=bankCard]").val(data.bankCard);
           $(":input[name=phone]").val(data.phone);
           $(":input[name=address]").val(data.address);
           $(":input[name=note]").val(data.note);
       });
    });
    function addAccount(){
        var idCard = $(":input[name=idCard]").val();
        var name =  $(":input[name=name]").val();
        var cardStatus =  $(":input[name=cardStatus]").val();
        var bankCard =  $(":input[name=bankCard]").val();
        var phone =  $(":input[name=phone]").val();
        var address = $(":input[name=address]").val();
        var note = $(":input[name=note]").val();
        $.ajax({
            url:"/bmpw/zc/account/addAccountFromPage",
            dataType:"json",
            type:"post",
            data:{"idCard":idCard,"name":name,"cardStatus":cardStatus,
                "bankCard":bankCard,"phone":phone,
                "address":address,"note":note},
            success:function(data){
                if(data==true){
                    alert("添加成功！");
                    location.reload();
                }else{
                    alert("添加失败！请检查信息是否有误！");
                }
            },
            error:function(){
                alert("添加失败！请稍后重试！");
            }
        });
    }
    function updateAccount() {
        var idCard = $(":input[name=idCard]").val();
        var name = $(":input[name=name]").val();
        var cardStatus = $(":input[name=cardStatus]").val();
        var bankCard = $(":input[name=bankCard]").val();
        var phone = $(":input[name=phone]").val();
        var address = $(":input[name=address]").val();
        var note = $(":input[name=note]").val();
        var id = $(":input[name=accountId]").val();
        $.ajax({
            url: "/bmpw/zc/account/updateAccountFromPage",
            dataType: "json",
            type: "post",
            data: {"id": id, "idCard": idCard, "name": name, "cardStatus": cardStatus,
                "bankCard": bankCard, "phone": phone,
                "address": address, "note": note},
            success: function (data) {
                if (data == true) {
                    alert("更新成功！");
                    location.reload();
                } else {
                    alert("sorry,更新失败！请检查数据是否正确。");
                }
            },
            error: function () {
                alert("sorry,更新失败！请稍后重试！");
            }
        });
    }
</script>
</body>
</html>